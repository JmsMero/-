<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
<!--    <script type="text/javascript">-->
<!--        (function (global) {-->

<!--            if(typeof (global) === "undefined") {-->
<!--                throw new Error("window is undefined");-->
<!--            }-->

<!--            var _hash = "!";-->
<!--            var noBackPlease = function () {-->
<!--                global.location.href += "#";-->

<!--                // making sure we have the fruit available for juice (^__^)-->
<!--                global.setTimeout(function () {-->
<!--                    global.location.href += "!";-->
<!--                }, 50);-->
<!--            };-->

<!--            global.onhashchange = function () {-->
<!--                if (global.location.hash !== _hash) {-->
<!--                    global.location.hash = _hash;-->
<!--                }-->
<!--            };-->

<!--            global.onload = function () {-->
<!--                noBackPlease();-->

<!--                // disables backspace on page except on input fields and textarea..-->
<!--                document.body.onkeydown = function (e) {-->
<!--                    var elm = e.target.nodeName.toLowerCase();-->
<!--                    if (e.which === 8 && (elm !== 'input' && elm  !== 'textarea')) {-->
<!--                        e.preventDefault();-->
<!--                    }-->
<!--                    // stopping event bubbling up the DOM tree..-->
<!--                    e.stopPropagation();-->
<!--                };-->
<!--            }-->

<!--        })(window);-->
<!--    </script>-->
<!--    <script>-->
<!--        addEventBack();-->

<!--        function addEventBack(){-->
<!--            pushHistory();-->
<!--            window.addEventListener("popstate",addBackKey, false);-->
<!--            function pushHistory() {-->
<!--                var state = {-->
<!--                    title: "title",-->
<!--                    url: "#"-->
<!--                };-->
<!--                window.history.pushState(state, "title", "#jjjj");-->
<!--            }-->
<!--        }-->

<!--        function addBackKey(){-->
<!--            var res = confirm("是否确认离开当前页面？");-->
<!--            if (res == true) {-->
<!--                window.location.href="/aaa.html";-->
<!--            }else{-->
<!--                addEventBack();-->
<!--                history.pushState(state, null, location.href);-->
<!--            }-->
<!--        }-->
<!--    </script>-->
    <style>
        #Popup{
            display: none;
        }
    </style>
    <script>
        /**
         * 使用 HTML5 的 History 新 API pushState 来曲线监听 Android 设备的返回按钮
         * XBack.listen(function(){
            alert('oh! you press the back button');
            });
         */
        ;!function(pkg, undefined){
            var STATE = 'x-back';
            var element;
            var onPopState = function(event){
                event.state === STATE && fire();
            }
            var record = function(state){
                history.pushState(state, null, location.href);
            }
            var fire = function(){
                var event = document.createEvent('Events');
                event.initEvent(STATE, false, false);
                element.dispatchEvent(event);
            }
            var listen = function(listener){
                    element.addEventListener(STATE, listener, false);
                }
            ;!function(){
                element = document.createElement('span');
                window.addEventListener('popstate', onPopState);
                this.listen = listen;
                record(STATE);
            }.call(window[pkg] = window[pkg] || {});
        }('XBack');
        XBack.listen(function(){
            let popup =document.getElementById('Popup');
            popup.style.display = 'block'
        })
    </script>
</head>
<body>
<p id="logView">test</p>
<div id="Popup">
    <p>真的要离开吗？</p>
    <div>
        <button class="determine">确定</button>
        <button class="cancel">取消</button>
    </div>
</div>
<div id="popup-back"></div>
</body>
</html>
